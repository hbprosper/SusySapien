<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PhysicsToolsLiteAnalysis: KDE Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>KDE Class Reference</h1><!-- doxytag: class="KDE" -->
<p><code>#include &lt;<a class="el" href="_k_d_e_8hpp_source.html">KDE.hpp</a>&gt;</code></p>

<p><a href="class_k_d_e-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#a2cf13699796f53a6446ba207ab3c2cb7">KDE</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#a638cbcd159063b17faf296848609b892">KDE</a> (std::string vars, double partition=0.9)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#a7c18c2ba7700a7d9be927ba84f25f03a">~KDE</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#a04dd2517e37cdf9bcda2c8dfc6f24a03">good</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#a0c7b76947721eaeb312fd5e43f1a0116">add</a> (std::vector&lt; double &gt; &amp;d)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#ac2c98f4a7ea63a75545e51bff7bf045f">printbw</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#ae65a963cf6ab98aa31c5d6a202bc219e">normalize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#ae894c3a9ed266fcce45b0486911fa994">optimize</a> (double scale=10, int maxiter=1000)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#a20cae47881b6e51fe6a70ff3e1f30154">density</a> (std::vector&lt; double &gt; &amp;x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#ae033f7e617b02c3aa2b08c63508c2032">density</a> (double x, std::string var)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#a947c037f6cff2649956bd0d4dce872a1">operator()</a> (std::vector&lt; double &gt; &amp;x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#afc0a6dcec824644ddf81d5b4d1d9db70">operator()</a> (double x, std::string var)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#a87bd9b7456cb72af861ae24f0f947a65">bandwidth</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#a765b424b15c5afcbe0b5b7a48d05eb2c">lambda</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#a2b71419ca9de7ae2516a1297b0013227">integral</a> (std::vector&lt; double &gt; &amp;a, std::vector&lt; double &gt; &amp;b)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#a491e051dc4084cb6bbe407438753d4d8">logprior</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#aa01aa732a78a3efc310218497882e26b">loglikelihood</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#a990b880c7e3e8e76b6474af0a57648e8">write</a> (std::string name)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#ad8bee9910a7d1a5caa0280fb4c3a27a6">setlambda</a> (double lambda)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#a3253d4932a71eb1633a8eacd49af9d74">setvars</a> (std::vector&lt; std::string &gt; &amp;vars)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#ad49c744905ac48902de126f826764f25">setlower</a> (std::vector&lt; double &gt; &amp;x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#acc7cbe70994dce630e1d07754fc3fd4d">setupper</a> (std::vector&lt; double &gt; &amp;x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_k_d_e.html#ab7e89092de620f1fb71c4010b6957d7b">setbandwidth</a> (std::vector&lt; double &gt; &amp;bandw)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Model a Kernel Density Estimate (<a class="el" href="class_k_d_e.html">KDE</a>) of a multivariate density. <b>Introduction</b> </p>
<p>Kernel density estimation (<a class="el" href="class_k_d_e.html">KDE</a>) is a general non-parametric method to estimate D-dimensional probability densities. The basic idea is to place a kernel function (typically, a diagonal D-dimensional Gaussian) at each of <img class="formulaInl" alt="$N$" src="form_9.png"/> points sampled from the density to be estimated. In the simplest method, the kernel function located at each point has exactly the same shape. This is the method implemented in the <a class="el" href="class_k_d_e.html">KDE</a> class. </p>
<p>The <a class="el" href="class_k_d_e.html">KDE</a> is given by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(X) = (1/N) \sum_{i=1}^N K(X,Y_i), \]" src="form_10.png"/>
</p>
<p>where <img class="formulaInl" alt="$K(X,Y)$" src="form_11.png"/> is the kernel function, <img class="formulaInl" alt="$Y_i$" src="form_12.png"/> is the ith point in the D-dimensional space and <img class="formulaInl" alt="$X$" src="form_13.png"/> is the point at which an estimate of the density is needed. To see why this works, consider what happens if we arrange for <img class="formulaInl" alt="$K(X,Y)$" src="form_11.png"/> to get narrower as <img class="formulaInl" alt="$N$" src="form_9.png"/> goes to infinity. In this limit, <img class="formulaInl" alt="$K(X,Y)$" src="form_11.png"/> becomes <img class="formulaInl" alt="$\delta(X-Y)$" src="form_14.png"/> and we can write the equation as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(X) = \int K(X,Y) p(Y) dY = \int \delta(X-Y) p(Y) dY = p(X). \]" src="form_15.png"/>
</p>
<p>The <a class="el" href="class_k_d_e.html">KDE</a> recovers the true density as more and more points are used in the sum in Eq.(1).</p>
<p><b><a class="el" href="class_k_d_e.html">KDE</a> Class</b></p>
<p>The <a class="el" href="class_k_d_e.html">KDE</a> class uses the kernel </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ K(X,Y) = \prod_j^D \mbox{Gaussian}(x_j, y_j, h_j), \]" src="form_16.png"/>
</p>
<p> where </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ X = (x_1,...x_D, \;\;\; Y = (y_1,...y_D), \]" src="form_17.png"/>
</p>
<p> and </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mbox{Gaussian}(x, y, h) = \exp(-(x-y)^2/2 h^2)/h\sqrt(2 \pi). \]" src="form_18.png"/>
</p>
<p> The parameter <img class="formulaInl" alt="$h$" src="form_19.png"/> is called the bandwidth, of which there are <img class="formulaInl" alt="$D$" src="form_20.png"/>, one for each dimension. The bandwidths are free parameters that must be chosen appropriately. Choosing them well is critically important to the performance of a <a class="el" href="class_k_d_e.html">KDE</a>. If the bandwidths are too small, the <a class="el" href="class_k_d_e.html">KDE</a> will be very noisy; if they are too large, the <a class="el" href="class_k_d_e.html">KDE</a> will be too smooth. In the <a class="el" href="class_k_d_e.html">KDE</a> class, some default values for these bandwidths are used (see the <a class="el" href="class_k_d_e.html#ae894c3a9ed266fcce45b0486911fa994">optimize()</a> method). In principle, better choices for these parameters can be arrived at using the <a class="el" href="class_k_d_e.html#ae894c3a9ed266fcce45b0486911fa994">optimize()</a> method, which maximizes the posterior density of the bandwidths with respect to the bandwidths. </p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a2cf13699796f53a6446ba207ab3c2cb7"></a><!-- doxytag: member="KDE::KDE" ref="a2cf13699796f53a6446ba207ab3c2cb7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">KDE::KDE </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a638cbcd159063b17faf296848609b892"></a><!-- doxytag: member="KDE::KDE" ref="a638cbcd159063b17faf296848609b892" args="(std::string vars, double partition=0.9)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">KDE::KDE </td>
          <td>(</td>
          <td class="paramtype">std::string&nbsp;</td>
          <td class="paramname"> <em>vars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>partition</em> = <code>0.9</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a <a class="el" href="class_k_d_e.html">KDE</a> object. Provide a string containing a list of space delimited variable names, one for each dimension. </p>
<p>Example: </p>
<div class="fragment"><pre class="fragment">      <a class="code" href="class_k_d_e.html">KDE</a> kde(<span class="stringliteral">&quot;pt eta phi&quot;</span>);
</pre></div> 
</div>
</div>
<a class="anchor" id="a7c18c2ba7700a7d9be927ba84f25f03a"></a><!-- doxytag: member="KDE::~KDE" ref="a7c18c2ba7700a7d9be927ba84f25f03a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual KDE::~KDE </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a0c7b76947721eaeb312fd5e43f1a0116"></a><!-- doxytag: member="KDE::add" ref="a0c7b76947721eaeb312fd5e43f1a0116" args="(std::vector&lt; double &gt; &amp;d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KDE::add </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>d</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Add a point to <a class="el" href="class_k_d_e.html">KDE</a>. </p>

</div>
</div>
<a class="anchor" id="a87bd9b7456cb72af861ae24f0f947a65"></a><!-- doxytag: member="KDE::bandwidth" ref="a87bd9b7456cb72af861ae24f0f947a65" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; KDE::bandwidth </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return bandwidths. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>vector of bandwidth parameters </dd></dl>

</div>
</div>
<a class="anchor" id="ae033f7e617b02c3aa2b08c63508c2032"></a><!-- doxytag: member="KDE::density" ref="ae033f7e617b02c3aa2b08c63508c2032" args="(double x, std::string var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double KDE::density </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&nbsp;</td>
          <td class="paramname"> <em>var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Compute 1-D marginal density at specified point. </p>

</div>
</div>
<a class="anchor" id="a20cae47881b6e51fe6a70ff3e1f30154"></a><!-- doxytag: member="KDE::density" ref="a20cae47881b6e51fe6a70ff3e1f30154" args="(std::vector&lt; double &gt; &amp;x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double KDE::density </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>x</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Compute density at specified point. </p>

</div>
</div>
<a class="anchor" id="a04dd2517e37cdf9bcda2c8dfc6f24a03"></a><!-- doxytag: member="KDE::good" ref="a04dd2517e37cdf9bcda2c8dfc6f24a03" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool KDE::good </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return true if most recent operation was successful. </p>

</div>
</div>
<a class="anchor" id="a2b71419ca9de7ae2516a1297b0013227"></a><!-- doxytag: member="KDE::integral" ref="a2b71419ca9de7ae2516a1297b0013227" args="(std::vector&lt; double &gt; &amp;a, std::vector&lt; double &gt; &amp;b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double KDE::integral </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return integral of density over specified hyper-rectangular domain. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>- lower bounds of domain </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>- upper bounds of domain </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>- the value of the integral </dd></dl>

</div>
</div>
<a class="anchor" id="a765b424b15c5afcbe0b5b7a48d05eb2c"></a><!-- doxytag: member="KDE::lambda" ref="a765b424b15c5afcbe0b5b7a48d05eb2c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double KDE::lambda </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa01aa732a78a3efc310218497882e26b"></a><!-- doxytag: member="KDE::loglikelihood" ref="aa01aa732a78a3efc310218497882e26b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double KDE::loglikelihood </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return log of the likelihood of the bandwidths. </p>

</div>
</div>
<a class="anchor" id="a491e051dc4084cb6bbe407438753d4d8"></a><!-- doxytag: member="KDE::logprior" ref="a491e051dc4084cb6bbe407438753d4d8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double KDE::logprior </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return log of the prior density of the bandwidths. </p>

</div>
</div>
<a class="anchor" id="ae65a963cf6ab98aa31c5d6a202bc219e"></a><!-- doxytag: member="KDE::normalize" ref="ae65a963cf6ab98aa31c5d6a202bc219e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double KDE::normalize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Normalize density within current domain. The domain boundaries can be set using the <a class="el" href="class_k_d_e.html#ad49c744905ac48902de126f826764f25">setlower()</a> and <a class="el" href="class_k_d_e.html#acc7cbe70994dce630e1d07754fc3fd4d">setupper()</a> methods. By default, the boundaries are determined by the outermost points added to the <a class="el" href="class_k_d_e.html">KDE</a> using the <a class="el" href="class_k_d_e.html#a0c7b76947721eaeb312fd5e43f1a0116">add()</a> method. </p>

</div>
</div>
<a class="anchor" id="afc0a6dcec824644ddf81d5b4d1d9db70"></a><!-- doxytag: member="KDE::operator()" ref="afc0a6dcec824644ddf81d5b4d1d9db70" args="(double x, std::string var)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double KDE::operator() </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&nbsp;</td>
          <td class="paramname"> <em>var</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Compute 1-D marginal density at specified point. </p>

</div>
</div>
<a class="anchor" id="a947c037f6cff2649956bd0d4dce872a1"></a><!-- doxytag: member="KDE::operator()" ref="a947c037f6cff2649956bd0d4dce872a1" args="(std::vector&lt; double &gt; &amp;x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double KDE::operator() </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>x</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Compute density at specified point. </p>

</div>
</div>
<a class="anchor" id="ae894c3a9ed266fcce45b0486911fa994"></a><!-- doxytag: member="KDE::optimize" ref="ae894c3a9ed266fcce45b0486911fa994" args="(double scale=10, int maxiter=1000)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KDE::optimize </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>scale</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxiter</em> = <code>1000</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Optimize bandwidths, <img class="formulaInl" alt="$h$" src="form_19.png"/>. Maximize the posterior density of the bandwidths </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ p(h|x) = p(x|h) \pi(h), \]" src="form_21.png"/>
</p>
<p> with respect to the bandwidths, where <img class="formulaInl" alt="$p(x|h)$" src="form_22.png"/> is the likelihood function and <img class="formulaInl" alt="$\pi(h)$" src="form_23.png"/> is the prior. </p>
<p>Each bandwidth is searched is in the domain <img class="formulaInl" alt="$[0,scale \times h]$" src="form_24.png"/>, where <img class="formulaInl" alt="$h$" src="form_19.png"/> is the default bandwidth, computed using the expression</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ h = \sigma \left[\frac{4}{(D+2)N}\right]^{1/(D+4)}, \]" src="form_25.png"/>
</p>
<p>where <img class="formulaInl" alt="$\sigma$" src="form_26.png"/> is the standard deviation of the associated 1-D density, <img class="formulaInl" alt="$D$" src="form_20.png"/> is the dimensionality of the data, and <img class="formulaInl" alt="$N$" src="form_9.png"/> is the number of points in the <a class="el" href="class_k_d_e.html">KDE</a>. This expression is a good approximation to the optimal bandwidth for a Gaussian, but it may be far from optimal for non-Gaussian distributions. </p>

</div>
</div>
<a class="anchor" id="ac2c98f4a7ea63a75545e51bff7bf045f"></a><!-- doxytag: member="KDE::printbw" ref="ac2c98f4a7ea63a75545e51bff7bf045f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KDE::printbw </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab7e89092de620f1fb71c4010b6957d7b"></a><!-- doxytag: member="KDE::setbandwidth" ref="ab7e89092de620f1fb71c4010b6957d7b" args="(std::vector&lt; double &gt; &amp;bandw)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KDE::setbandwidth </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>bandw</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set bandwidths. </p>

</div>
</div>
<a class="anchor" id="ad8bee9910a7d1a5caa0280fb4c3a27a6"></a><!-- doxytag: member="KDE::setlambda" ref="ad8bee9910a7d1a5caa0280fb4c3a27a6" args="(double lambda)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KDE::setlambda </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>lambda</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad49c744905ac48902de126f826764f25"></a><!-- doxytag: member="KDE::setlower" ref="ad49c744905ac48902de126f826764f25" args="(std::vector&lt; double &gt; &amp;x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KDE::setlower </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>x</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set lower bounds of domain. </p>

</div>
</div>
<a class="anchor" id="acc7cbe70994dce630e1d07754fc3fd4d"></a><!-- doxytag: member="KDE::setupper" ref="acc7cbe70994dce630e1d07754fc3fd4d" args="(std::vector&lt; double &gt; &amp;x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KDE::setupper </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>x</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set lower bounds of domain. </p>

</div>
</div>
<a class="anchor" id="a3253d4932a71eb1633a8eacd49af9d74"></a><!-- doxytag: member="KDE::setvars" ref="a3253d4932a71eb1633a8eacd49af9d74" args="(std::vector&lt; std::string &gt; &amp;vars)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KDE::setvars </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::string &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>vars</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set variable names. </p>

</div>
</div>
<a class="anchor" id="a990b880c7e3e8e76b6474af0a57648e8"></a><!-- doxytag: member="KDE::write" ref="a990b880c7e3e8e76b6474af0a57648e8" args="(std::string name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KDE::write </td>
          <td>(</td>
          <td class="paramtype">std::string&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a self-contained C++ function that computes density. </p>

</div>
</div>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Sun Sep 19 13:15:02 2010 for PhysicsToolsLiteAnalysis by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
